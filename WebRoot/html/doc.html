<a name="JOne简介"></a>
<div class="panel panel-default" style="border: none;" id="section-1">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-book"></i> 简介</span>
        </h3>
    </div>
    <div class="panel-body">
		<p>JOne 是一个极速WEB开发框架，其设计目标是零配置、开发迅速、代码量少、轻量级、Restful。</p>
		<p>JOne的宗旨意在开发一个公共通用的权限管理、日志管理、异常管理、事务管理、任务管理等模块，易于集成的开发平台.让我们的开发人员不再为琐碎的权限菜单、日志、异常、事务、任务而“费劲“，只需关注业务的实现。</p>

		<p>JOne有如下主要特点：</p>
		<p><span class="badge"  style="background-color:#337ab7;">1</span> MVC架构，设计精巧，使用简单，开发迅速</p>

		<p><span class="badge"  style="background-color:#337ab7;">2</span> 约定大于配置原则，零配置,全系统只有一个Filter</p>

		<p><span class="badge"  style="background-color:#337ab7;">3</span> Action是一个普通的pojo，与servlet解耦，无侵入 REST风格的访问方式</p>

		<p><span class="badge"  style="background-color:#337ab7;">4</span> 支持本地以及WEB和Service分布式部署，基于netty框架的RPC实现</p>
		
		<p><span class="badge"  style="background-color:#337ab7;">5</span> 支持动态sql</p>

		<p><span class="badge"  style="background-color:#337ab7;">6</span> 数据持久化，由于考虑到业务的复杂性（特别是查询的效率），没有采用ORM方式，而是对JDBC的封装 调用快速方便</p>

		<p><span class="badge"  style="background-color:#337ab7;">7</span> 事务采用AOP实现无侵入设计。日志的记录采用AOP，异步阻塞队列实现 开发者无需关注事务和日志的处理</p>
		
		<p><a href="doc/down?file=JOne.jar" class="btn btn-primary"><i class="fa fa-download"></i> 下载JOne.jar</a>
    </div>
</div>
<a name="JOne配置"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-cog"></i> 配置</span>
        </h3>
    </div>
    <div class="panel-body">
JOne核心只有一个Filter(com.rz.web.JOne), 在web.xml中配置即可
<pre class="mydoc"><code class="xml">&lt;filter&gt;
 &lt;filter-name&gt;JOne&lt;/filter-name&gt;
 &lt;filter-class&gt;com.rz.web.JOne&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
 &lt;filter-name&gt;JOne&lt;/filter-name&gt;
 &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
非必须可选的配置项base-package, 也可以在web.xml配置
&lt;init-param&gt;
  &lt;param-name&gt;base-package&lt;/param-name&gt;
  &lt;param-value&gt;com.*.*&lt;/param-value&gt;
&lt;/init-param&gt;
不配置默认为空.
</code></pre>
<p>JOne启动的时候会到base-package下面的action、interceptor、plugin目录
分别加载初始化Action、Interceptor、Plugin</p>
<p>plugin通常用来项目启动之前做一些初始化工作, 例如：数据库的初始化、任务管理器的启动等等。
只要实现Plugin接口即可(与ServletContextListener类似)</p>
    </div>
</div>
<a name="编写Action"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-code"></i> 编写Action</span>
        </h3>
    </div>
    <div class="panel-body">
	<p>前端访问Action规则: <span class="label label-danger">http://ip:port/actionName[/actionMethod]</span></p>
	<p><span class="label label-danger">actionName</span>--首字母大写后即为Action名</p>
	<p><span class="label label-danger">actionMethod</span>--对应Action里的方法名(不写默认请求的是execute方法)</p>
<pre class="mydoc"><code class="java">
base-package/action下编写一个POJO:

public class Hello
{
	public View execute()
	{
		String name = WebUtil.getParameter("name");
		return new Json("Hello" + name);
	}
}
以这个Action为例, 前端访问url为:http://ip:port/hello 默认请求execute方法
打开浏览器访问http://localhost/hello?name=haha吧！
</code></pre>
    </div>
</div>
<a name="关于DB"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-database"></i> 关于DB</span>
        </h3>
    </div>
    <div class="panel-body">
<pre class="mydoc"><code class="java">
cfg.json: 系统的配置都放在这儿
{	
	datasource : { 
		hsqldb: { 
			driverClassName : "org.hsqldb.jdbcDriver", 
			url : "jdbc:hsqldb:file:/home/rzy/database/dmas.db", 
			username : "SA", 
			password : "" 
		}, 
		dbone: { 
			driverClassName : "com.intple.dbone.Driver", 
			url : "jdbc:dbone://11.0.1.83:9001/", 
			username : "dbone", 
			password : "dbone" 
		}
	}
}
这里配置了2个数据源

<b>概念</b>
DB：代表一个连接池  对应于cfg.json里配置项datasource中一个具体的配置 如:hsqldb
DBs: 系统所有的连接池集合 对应于cfg.json里的配置项datasource
R: 你可以把它看做一个Map.是一个重要的数据载体, 穿梭在Action、Service和数据库操作间!

<b>获取DB</b>
DB db = DBs.getDB("mysql");

<b>增、删、改</b>
String sql = "delete from users where username = ?";
db.begin();
db.update(sql, new Object[] { username });
db.commit();

<b>查询单条记录</b>
String sql = "select  * from users where username=? and pwd=?";
R r = db.findOne(sql, new Object[] { username, password });

<b>单值查询</b>
String sql = "select  count(1) from users";
Object o = db.scalar(sql);

<b>查询多条记录</b>
String sql = "select  * from users";
List&lt;R&gt; list = db.find(sql, new Object[] { username, password });

<b>分页查询</b>
String sql = "select  * from users";
List&lt;R&gt; list = db.pager(sql, 1, 10);
</code></pre>
    </div>
</div>
<a name="动态sql"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-file"></i> 动态sql</span>
        </h3>
    </div>
    <div class="panel-body">
<pre class="mydoc"><code class="sql">
<b>以用户相关的db操作为例，在sql目录下新建一个user.sql文件</b>
count
===
select count(1) from users where 1=1
@if(isNotEmpty(name)){
and name = #{name}
@}
and isadmin = 0

list
===
select * from users where 1=1
@if(isNotEmpty(name)){
and name = #{name}
@}
and isadmin = 0
order by regtime DESC

===上面的是sqlid(同一个文件唯一)
===下面的是动态sql

<b>使用：</b>
DB db = DBs.get("hsqldb");
SQLExecutor executor = new SQLExecutor(db);
int total = 0;
Object o = executor.scalar("log.count", params);
if (o != null)
{
	total = Integer.valueOf(o.toString());
}
List&lt;R&gt; list = executor.pager("log.list", params, page, pagesize);
</code></pre>
    </div>
</div>
<a name="如何编写Service"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-pencil"></i> 如何编写Service</span>
        </h3>
    </div>
    <div class="panel-body">
<pre class="mydoc"><code class="java">
<b>已登录为例:</b>
public class AuthService
{
	static DB db = DBs.getDB("hsqldb");//这里获取数据库操作工具类

	public boolean login(String username, String password)
	{
		String sql = "select  * from users where username=? and pwd=?";
		R r = db.findOne(sql, new Object[] { username, password });
		return (r != null);
	}
}
</code></pre>
    </div>
</div>
<a name="如何获取系统配置"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-wrench"></i> 如何获取系统配置</span>
        </h3>
    </div>
    <div class="panel-body">
<pre class="mydoc"><code class="java">
前面讲到有一个系统配置文件cfg.json,系统的所有配置可以放在这个文件里
{	
	datasource : { 
		hsqldb: { 
			driverClassName : "org.hsqldb.jdbcDriver", 
			url : "jdbc:hsqldb:file:/home/rzy/database/dmas.db", 
			username : "SA", 
			password : "" 
		}, 
		dbone: { 
			driverClassName : "com.intple.dbone.Driver", 
			url : "jdbc:dbone://11.0.1.83:9001/", 
			username : "dbone", 
			password : "dbone" 
		}
	},
	IP: 11.0.1.1,
	path: abc/a/c
}
这里配置了2个数据源、IP、path

<b>获取配置项</b>
String url = (String)Config.getValue("datasource.hsqldb.url");
</code></pre>
    </div>
</div>
<a name="任务管理器"></a>
<div class="panel panel-default" style="border: none;">
    <div class="panel-heading" style="background-color: #fff;">
        <h3 class="panel-title">
            <span class="text-primary"><i class="fa fa-tasks"></i> 任务管理器</span>
        </h3>
    </div>
    <div class="panel-body">
     <div class="toolbar">
    	<a id="add" type="button" class="btn btn-primary"><i class="fa fa-plus"></i> 增加</a>
     </div>
		    <div id="tasks">
		   
		    </div>
    </div>
</div>
</div>